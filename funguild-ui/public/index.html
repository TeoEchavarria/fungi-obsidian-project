<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fungal Guild DB (SQLite in Browser)</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 0; }
    header { padding: 12px 16px; border-bottom: 1px solid #ddd; display:flex; justify-content:space-between; align-items:center; gap: 12px; }
    header h1 { font-size: 16px; margin: 0; }
    .wrap { padding: 16px; }
    .filters { display:grid; grid-template-columns: 2fr 1fr 1fr 2fr auto; gap: 10px; align-items:end; }
    label { font-size: 12px; color: #333; display:block; margin-bottom: 4px; }
    input, select { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 10px; }
    button { padding: 9px 12px; border: 1px solid #111; background: #111; color: #fff; border-radius: 10px; cursor:pointer; }
    button.secondary { background:#fff; color:#111; }
    .meta { margin-top: 10px; font-size: 12px; color:#555; display:flex; justify-content:space-between; gap: 10px; flex-wrap:wrap; }
    table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    th, td { text-align: left; padding: 10px; border-bottom: 1px solid #eee; }
    th { font-size: 12px; color:#444; }
    tr:hover { background:#fafafa; cursor:pointer; }
    .pager { display:flex; gap: 8px; align-items:center; }
    .pill { padding: 4px 8px; border: 1px solid #ddd; border-radius: 999px; font-size: 12px; }

    /* modal */
    .modal-backdrop { position: fixed; inset:0; background: rgba(0,0,0,.5); display:none; align-items:center; justify-content:center; padding: 18px; }
    .modal { width: min(900px, 100%); background:#fff; border-radius: 16px; overflow:hidden; box-shadow: 0 20px 80px rgba(0,0,0,.35); }
    .modal-header { padding: 12px 14px; border-bottom: 1px solid #eee; display:flex; justify-content:space-between; gap: 10px; align-items:center; }
    .modal-header strong { font-size: 14px; }
    .modal-body { padding: 14px; max-height: 70vh; overflow:auto; }
    .kv { display:grid; grid-template-columns: 220px 1fr; gap: 10px; padding: 8px 0; border-bottom: 1px dashed #eee; }
    .k { color:#555; font-size:12px; }
    .v { white-space: pre-wrap; word-break: break-word; }
    .modal-actions { display:flex; gap: 8px; }
    .status { font-size: 12px; color: #333; }
  </style>
</head>

<body>
<header>
  <h1>Fungal Guild DB</h1>
  <div class="status" id="status">Loading…</div>
</header>

<div class="wrap">
  <div class="filters">
    <div>
      <label>Taxon (contains)</label>
      <input id="fTaxon" type="text" placeholder="e.g. Abrothallus" />
    </div>
    <div>
      <label>TrophicMode</label>
      <select id="fTrophicMode">
        <option value="">(Any)</option>
      </select>
    </div>
    <div>
      <label>GrowthForm</label>
      <select id="fGrowthForm">
        <option value="">(Any)</option>
      </select>
    </div>
    <div>
      <label>Guild</label>
      <select id="fGuild">
        <option value="">(Any)</option>
      </select>
    </div>
    <div style="display:flex; gap:8px;">
      <button id="btnApply">Apply</button>
      <button id="btnReset" class="secondary">Reset</button>
    </div>
  </div>

  <div class="meta">
    <div class="pill" id="metaText">—</div>
    <div class="pager">
      <button id="btnPrev" class="secondary">Prev</button>
      <button id="btnNext" class="secondary">Next</button>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>Taxon</th>
        <th>TrophicMode</th>
        <th>GrowthForm</th>
        <th>Guild</th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>
</div>

<!-- Modal -->
<div class="modal-backdrop" id="modalBackdrop">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-header">
      <strong id="modalTitle">Record</strong>
      <div class="modal-actions">
        <button id="btnCopy" class="secondary">Copy JSON</button>
        <button id="btnClose">Close</button>
      </div>
    </div>
    <div class="modal-body" id="modalBody"></div>
  </div>
</div>

<!-- sql.js loader (local file copied from node_modules/sql.js/dist/) -->
<script src="./sql-wasm.js"></script>
<script src="./app.js"></script>
</body>
</html>
